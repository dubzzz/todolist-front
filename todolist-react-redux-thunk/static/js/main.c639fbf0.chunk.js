(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{121:function(t,e,n){"use strict";n.r(e);var r,a=n(0),u=n.n(a),o=n(7),c=n.n(o),i=n(24),s=n(40),d=n(86),f=n(13),l=n(26);!function(t){t.NonAuthenticated="NonAuthenticated",t.OnGoingAuthentication="OnGoingAuthentication",t.Authenticated="Authenticated"}(r||(r={}));var p={username:"",token:"",status:r.NonAuthenticated},v=n(15),b=n(33),h=Object(s.c)({authentication:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case l.c:var n=e.payload,a=n.username,u=n.token;return Object(f.a)({},t,{username:a,token:u,state:r.Authenticated});case l.a:return Object(f.a)({},t,{state:r.NonAuthenticated});case l.b:return Object(f.a)({},t,{state:r.OnGoingAuthentication});default:return t}},notification:v.b,todolist:b.b}),m=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||s.d,O=Object(s.e)(h,m(Object(s.a)(d.a))),g=n(53),j=n(43),E=n(158);function y(t){switch(Object(i.c)(function(t){return t.authentication.status})){case r.OnGoingAuthentication:case r.NonAuthenticated:return u.a.createElement(j.a,{to:{pathname:"/login",search:"?redirect=".concat(encodeURIComponent(t.location.pathname))}});case r.Authenticated:return u.a.createElement(a.Suspense,{fallback:u.a.createElement(E.a,null)},t.children)}}function w(t){var e=Object(j.g)(y);return function(n){return u.a.createElement(e,null,u.a.createElement(t,n))}}var k=n(50),_=n(79),T=n(167),S=n(168),x=n(160),N=n(166),A=n(162),I=n(125),L=n(161),R=Object(_.a)({cardContainer:{padding:20,textAlign:"center"},card:{display:"inline-block",maxWidth:345},hint:{fontSize:12},media:{height:140}});var C=Object(j.g)(function(t){var e=R(),n=Object(i.c)(function(t){return t.authentication.status}),o=Object(i.b)(),c=Object(a.useState)(""),s=Object(k.a)(c,2),d=s[0],f=s[1],p=Object(a.useState)(""),v=Object(k.a)(p,2),b=v[0],h=v[1],m=n===r.NonAuthenticated&&d&&b,O=n===r.OnGoingAuthentication;if(n===r.Authenticated){var g=new URLSearchParams(t.location.search).get("redirect")||"/";return u.a.createElement(j.a,{to:g})}return u.a.createElement("div",{className:e.cardContainer},u.a.createElement(x.a,{className:e.card},u.a.createElement(L.a,{className:e.media,image:"https://upload.wikimedia.org/wikipedia/commons/f/f6/Eiffel_Tower_and_the_Trocadero%2C_Exposition_Universal%2C_1900%2C_Paris%2C_France.jpg",title:"Eiffel Tower"}),u.a.createElement(A.a,null,u.a.createElement(I.a,{gutterBottom:!0,variant:"h5",component:"h2"},"Welcome to TodoList React with redux-thunk"),u.a.createElement(I.a,{className:e.hint,color:"textSecondary",gutterBottom:!0},"Try with password: \u201cpassword\u201d"),u.a.createElement(S.a,{label:"Username",value:d,onChange:function(t){return f(t.currentTarget.value)},onKeyPress:function(t){13===t.which&&m&&(o(Object(l.d)(d,b)),t.preventDefault())}}),u.a.createElement("br",null),u.a.createElement(S.a,{label:"Password",type:"password",value:b,onChange:function(t){return h(t.currentTarget.value)},onKeyPress:function(t){13===t.which&&m&&(o(Object(l.d)(d,b)),t.preventDefault())}})),u.a.createElement(N.a,null,u.a.createElement(T.a,{color:"primary",disabled:!m,onClick:function(){return o(Object(l.d)(d,b))}},"Login"),O?u.a.createElement(E.a,{size:24}):u.a.createElement(u.a.Fragment,null))))}),D=n(91),P=n(37),q=n(62),U=n(17);function G(t){var e=function(t,e){if("object"!==typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===typeof e?e:String(e)}var F=Object(q.withSnackbar)(function(t){var e=t.enqueueSnackbar,n=Object(a.useState)({}),r=Object(k.a)(n,2),u=r[0],o=r[1],c=Object(i.c)(function(t){return t.notification.notifications}),s=Object(i.b)();return Object(a.useEffect)(function(){var t=function(t){switch(t){case v.a.Success:return"success";case v.a.Info:return"info";case v.a.Warn:return"warning";case v.a.Error:return"error";case v.a.Log:default:return"default"}},n=!0,r=!1,a=void 0;try{for(var i,d=function(){var n=i.value;if(u[n.id])return"continue";o(function(t){return Object(f.a)({},t,Object(P.a)({},n.id,!0))}),e(n.message,{variant:t(n.level),onClose:function(){o(function(t){var e=n.id;return t[e],Object(D.a)(t,[e].map(G))})}}),s(Object(U.d)(n.id))},l=c[Symbol.iterator]();!(n=(i=l.next()).done);n=!0)d()}catch(p){r=!0,a=p}finally{try{n||null==l.return||l.return()}finally{if(r)throw a}}},[c,u,s,e]),null}),M=function(){return Promise.all([n.e(3),n.e(5)]).then(n.bind(null,208))},W=u.a.lazy(M),J=function(){var t=Object(i.b)();return Object(a.useEffect)(function(){M()},[]),Object(a.useEffect)(function(){t(Object(l.e)())},[t]),u.a.createElement("div",{className:"App"},u.a.createElement(q.SnackbarProvider,{maxSnack:3},u.a.createElement(F,null),u.a.createElement(g.a,null,u.a.createElement(j.d,null,u.a.createElement(j.b,{exact:!0,path:"/login",component:C}),u.a.createElement(j.b,{component:w(W)})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(u.a.createElement(i.a,{store:O},u.a.createElement(J,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},15:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r,a=n(49),u=n(13),o=n(17);!function(t){t.Log="Log",t.Success="Success",t.Info="Info",t.Warn="Warn",t.Error="Error"}(r||(r={}));var c={notifications:[]};e.b=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case o.a:var n=e.payload,r=n.id,i=n.message,s=n.level;return Object(u.a)({},t,{notifications:[].concat(Object(a.a)(t.notifications),[{id:r,message:i,level:s}])});case o.b:var d=e.payload.id;return Object(u.a)({},t,{notifications:t.notifications.filter(function(t){return t.id!==d})});default:return t}}},17:function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"b",function(){return a}),n.d(e,"c",function(){return u}),n.d(e,"d",function(){return o});var r="NOTIFICATION_ADD",a="NOTIFICATION_REMOVE",u=function(t,e){return{type:r,payload:{id:Math.random().toString(16).substr(2),message:t,level:e}}},o=function(t){return{type:a,payload:{id:t}}}},20:function(t,e,n){"use strict";n.d(e,"f",function(){return i}),n.d(e,"c",function(){return s}),n.d(e,"g",function(){return d}),n.d(e,"j",function(){return f}),n.d(e,"d",function(){return l}),n.d(e,"b",function(){return v}),n.d(e,"i",function(){return b}),n.d(e,"a",function(){return h}),n.d(e,"e",function(){return m}),n.d(e,"h",function(){return O});var r=n(10),a=n.n(r),u=n(49),o=n(22),c=function(){var t=window.validToken||"w\u20aclc0Me";return window.validToken=t,t},i=function(t,e){return"password"!==e?E(500):j({username:t,token:c()},500)},s=function(t){return t!==c()?j(!1,500):j(!0,500)},d=function(t,e){return localStorage.getItem("".concat(t,"::").concat(e))||""},f=function(t,e,n){return localStorage.setItem("".concat(t,"::").concat(e),n)},l=function(t,e){return localStorage.removeItem("".concat(t,"::").concat(e))},p=function(){var t=d("Todos","data");return t?JSON.parse(t):[]},v=function(t,e,n){var r={_i:{}},a=function a(){if(t!==c())return r._i._handleId=void 0,void n();var u=p();(function(t){if(void 0===r._i._data)return!0;if(r._i._data.length!==t.length)return!0;return!!r._i._data.some(function(e,n){return r=e,a=t[n],!(r.guid===a.guid&&r.task===a.task&&r.done===a.done);var r,a})})(u)&&(r._i._data=u,e(u)),r._i._handleId=setTimeout(function(){return a()},500)};return r._i._handleId=setTimeout(function(){return a()},500),r},b=function(t){t._i._handleId&&clearTimeout(t._i._handleId)},h=function(){var t=Object(o.a)(a.a.mark(function t(e,n){var r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g(500);case 2:if(e===c()){t.next=4;break}return t.abrupt("return",!1);case 4:if(!(r=p()).some(function(t){return t.guid===n.guid})){t.next=7;break}return t.abrupt("return",!1);case 7:return f("Todos","data",JSON.stringify([].concat(Object(u.a)(r),[n]))),t.abrupt("return",!0);case 9:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}(),m=function(){var t=Object(o.a)(a.a.mark(function t(e,n){var r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g(500);case 2:if(e===c()){t.next=4;break}return t.abrupt("return",!1);case 4:if((r=p()).some(function(t){return t.guid===n.guid})){t.next=7;break}return t.abrupt("return",!1);case 7:return f("Todos","data",JSON.stringify(r.map(function(t){return t.guid===n.guid?n:t}))),t.abrupt("return",!0);case 9:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}(),O=function(){var t=Object(o.a)(a.a.mark(function t(e,n){var r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g(500);case 2:if(e===c()){t.next=4;break}return t.abrupt("return",!1);case 4:if((r=p()).some(function(t){return t.guid===n.guid})){t.next=7;break}return t.abrupt("return",!1);case 7:return f("Todos","data",JSON.stringify(r.filter(function(t){return t.guid!==n.guid}))),t.abrupt("return",!0);case 9:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}(),g=function(t){return new Promise(function(e,n){setTimeout(function(){return e()},t)})},j=function(t,e){return new Promise(function(n,r){setTimeout(function(){return n(t)},e)})},E=function(t){return new Promise(function(e,n){setTimeout(function(){return n()},t)})}},26:function(t,e,n){"use strict";n.d(e,"c",function(){return s}),n.d(e,"a",function(){return d}),n.d(e,"b",function(){return f}),n.d(e,"d",function(){return h}),n.d(e,"e",function(){return m}),n.d(e,"f",function(){return O});var r=n(10),a=n.n(r),u=n(22),o=n(20),c=n(17),i=n(15),s="AUTHENTICATION_LOGIN_SUCCESS",d="AUTHENTICATION_LOGIN_FAILURE",f="AUTHENTICATION_LOGIN_ON_GOING",l=function(t,e){return{type:s,payload:{username:t,token:e}}},p=function(){return{type:d,payload:{}}},v=function(){return{type:f,payload:{}}},b=function(t,e){o.j("AuthenticationProvider","username",t),o.j("AuthenticationProvider","token",e)},h=function(t,e){return function(){var n=Object(u.a)(a.a.mark(function n(r){var u;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(v()),n.prev=1,n.next=4,o.f(t,e);case 4:u=n.sent,b(u.username,u.token),r(l(u.username,u.token)),r(Object(c.c)("Login successful",i.a.Success)),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(1),r(p()),r(Object(c.c)("Login failure",i.a.Error));case 14:case"end":return n.stop()}},n,null,[[1,10]])}));return function(t){return n.apply(this,arguments)}}()},m=function(){return function(){var t=Object(u.a)(a.a.mark(function t(e){var n,r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=o.g("AuthenticationProvider","username"),""!==(r=o.g("AuthenticationProvider","token"))){t.next=4;break}return t.abrupt("return");case 4:return e(v()),t.next=7,o.c(r);case 7:t.sent?(b(n,r),e(l(n,r)),e(Object(c.c)("Login successful",i.a.Success))):e(p());case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},O=function(t){return function(){var e=Object(u.a)(a.a.mark(function e(n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o.d("AuthenticationProvider","username"),o.d("AuthenticationProvider","token"),n(p()),t||n(Object(c.c)("Logout successful",i.a.Success));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}},33:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r,a=n(49),u=n(37),o=n(13),c=n(47);!function(t){t.Noop="noop",t.Add="add",t.Edit="edit",t.Remove="remove"}(r||(r={}));var i={ready:!1,todos:[],handle:null,requesters:[]};e.b=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case c.a:var n=e.payload,s=n.todo,d=n.state,f=[],l=!1,p=!0,v=!1,b=void 0;try{for(var h,m=t.todos[Symbol.iterator]();!(p=(h=m.next()).done);p=!0){var O=h.value;O.data.guid===s.guid?(l=!0,f.push({data:s,state:d})):f.push(O)}}catch(A){v=!0,b=A}finally{try{p||null==m.return||m.return()}finally{if(v)throw b}}return l||f.push({data:s,state:d}),Object(o.a)({},t,{todos:f});case c.e:var g=e.payload.guid;return Object(o.a)({},t,{todos:t.todos.filter(function(t){return t.data.guid!==g})});case c.c:var j=e.payload.todos,E=t.todos.filter(function(t){return t.state===r.Add}).reduce(function(t,e){return Object(o.a)({},t,Object(u.a)({},e.data.guid,e.data))},{}),y=t.todos.filter(function(t){return t.state===r.Edit}).reduce(function(t,e){return Object(o.a)({},t,Object(u.a)({},e.data.guid,e.data))},{}),w=t.todos.filter(function(t){return t.state===r.Remove}).reduce(function(t,e){return Object(o.a)({},t,Object(u.a)({},e.data.guid,e.data))},{});return Object(o.a)({},t,{ready:!0,todos:j.filter(function(t){return void 0===E[t.guid]}).map(function(t){return y[t.guid]?{state:r.Edit,data:y[t.guid]}:w[t.guid]?{state:r.Remove,data:w[t.guid]}:{state:r.Noop,data:t}}).concat(t.todos.filter(function(t){return t.state===r.Add}))});case c.b:var k=e.payload,_=k.handle,T=k.requester;return t.requesters.includes(T)?Object(o.a)({},t,{handle:_}):Object(o.a)({},t,{handle:_,requesters:[].concat(Object(a.a)(t.requesters),[T])});case c.d:var S=e.payload,x=S.handle,N=S.requester;return Object(o.a)({},t,{handle:x,requesters:t.requesters.filter(function(t){return t!==N})});default:return t}}},47:function(t,e,n){"use strict";n.d(e,"a",function(){return l}),n.d(e,"e",function(){return p}),n.d(e,"c",function(){return v}),n.d(e,"b",function(){return b}),n.d(e,"d",function(){return h}),n.d(e,"h",function(){return y}),n.d(e,"j",function(){return w}),n.d(e,"i",function(){return k}),n.d(e,"f",function(){return _}),n.d(e,"g",function(){return T});var r=n(13),a=n(10),u=n.n(a),o=n(22),c=n(20),i=n(33),s=n(17),d=n(15),f=n(26),l="TODOLIST_ADD_OR_EDIT_TODO",p="TODOLIST_REMOVE_TODO",v="TODOLIST_REFRESH_TODOS",b="TODOLIST_ADD_REQUESTER",h="TODOLIST_REMOVE_REQUESTER",m=function(t,e){return{type:l,payload:{todo:t,state:e}}},O=function(t){return{type:p,payload:{guid:t}}},g=function(t){return{type:v,payload:{todos:t}}},j=function(t,e){return{type:b,payload:{handle:t,requester:e}}},E=function(t,e){return{type:h,payload:{handle:t,requester:e}}},y=function(t,e){return function(){var n=Object(o.a)(u.a.mark(function n(r){var a,o;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=Math.random().toString(16).substr(2),r(m(o={guid:a,task:e,done:!1},i.a.Add)),n.prev=3,n.next=6,c.a(t,o);case 6:n.sent?r(m(o,i.a.Noop)):(r(Object(s.c)("Failed to add todo: ".concat(o.task),d.a.Error)),r(O(o.guid))),n.next=12;break;case 10:n.prev=10,n.t0=n.catch(3);case 12:case"end":return n.stop()}},n,null,[[3,10]])}));return function(t){return n.apply(this,arguments)}}()},w=function(t,e){return function(){var n=Object(o.a)(u.a.mark(function n(a,o){var f,l,p;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(f=o().todolist.todos,l=f.find(function(t){return t.data.guid===e&&t.state===i.a.Noop})){n.next=5;break}return a(Object(s.c)("No todo available for modification given guid ".concat(e),d.a.Error)),n.abrupt("return");case 5:return p=Object(r.a)({},l.data,{done:!l.data.done}),a(m(p,i.a.Edit)),n.prev=7,n.next=10,c.e(t,l.data);case 10:n.sent?a(m(p,i.a.Noop)):(a(Object(s.c)("Failed to edit todo: ".concat(l.data.task),d.a.Error)),a(m(l.data,l.state))),n.next=16;break;case 14:n.prev=14,n.t0=n.catch(7);case 16:case"end":return n.stop()}},n,null,[[7,14]])}));return function(t,e){return n.apply(this,arguments)}}()},k=function(t,e){return function(){var n=Object(o.a)(u.a.mark(function n(r,a){var o,f;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(o=a().todolist.todos,f=o.find(function(t){return t.data.guid===e&&t.state===i.a.Noop})){n.next=5;break}return r(Object(s.c)("No todo available for modification given guid ".concat(e),d.a.Error)),n.abrupt("return");case 5:return r(m(f.data,i.a.Remove)),n.prev=6,n.next=9,c.h(t,f.data);case 9:n.sent?r(O(f.data.guid)):(r(Object(s.c)("Failed to remove todo: ".concat(f.data.task),d.a.Error)),r(m(f.data,f.state))),n.next=15;break;case 13:n.prev=13,n.t0=n.catch(6);case 15:case"end":return n.stop()}},n,null,[[6,13]])}));return function(t,e){return n.apply(this,arguments)}}()},_=function(t,e){return function(){var n=Object(o.a)(u.a.mark(function n(r,a){var o;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:o=a().todolist.handle||c.b(t,function(t){return r(g(t))},function(){r(Object(s.c)("Revoked token, connection lost",d.a.Error)),Object(f.f)(!0)(r)}),r(j(o,e));case 2:case"end":return n.stop()}},n)}));return function(t,e){return n.apply(this,arguments)}}()},T=function(t){return function(){var e=Object(o.a)(u.a.mark(function e(n,r){var a,o,i;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=r().todolist,o=a.handle,1===(i=a.requesters).length&&i[0]===t?(c.i(o),n(E(null,t))):n(E(o,t));case 2:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}},99:function(t,e,n){t.exports=n(121)}},[[99,1,2]]]);
//# sourceMappingURL=main.c639fbf0.chunk.js.map