{"version":3,"sources":["context/TodoListContext.tsx","component/authenticated/AuthenticatedHeader.tsx","component/authenticated/AuthenticatedMenu.tsx","hook/WindowDimension.tsx","component/authenticated/AuthenticatedApp.tsx"],"names":["TodoState","defaultTodoList","TodoListContext","createContext","TodoListProvider","props","error","useNotification","_useAuthentication","useAuthentication","token","logout","_useState","useState","_useState2","Object","_home_travis_build_dubzzz_todolist_front_todolist_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__","ready","setReady","_useState3","_useState4","todos","setTodos","useEffect","handle","Api","newTodos","ts","todosBeingAdded","filter","t","state","Add","reduce","acc","_home_travis_build_dubzzz_todolist_front_todolist_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__","_home_travis_build_dubzzz_todolist_front_todolist_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__","data","guid","todosBeingEdited","Edit","todosBeingRemoved","Remove","undefined","map","Noop","concat","react__WEBPACK_IMPORTED_MODULE_4___default","a","createElement","Provider","assign","value","addTodo","task","Math","random","toString","substr","todo","done","_home_travis_build_dubzzz_todolist_front_todolist_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","then","r","toggleTodo","prevTodo","find","removeTodo","useTodoList","context","useContext","Error","useStyles","makeStyles","theme","appBar","zIndex","drawer","transition","transitions","create","easing","sharp","duration","leavingScreen","appBarShift","marginLeft","width","enteringScreen","menuButtonHidden","display","title","flexGrow","AuthenticatedHeader","classes","username","_useTodoList","react_default","AppBar","position","className","clsx","drawerOpened","Toolbar","IconButton","edge","color","aria-label","onClick","toggleDrawer","Menu_default","Typography","variant","Badge","badgeContent","length","ShoppingCart_default","PowerSettingsNew_default","drawerWidth","toolbarIcon","objectSpread","alignItems","justifyContent","padding","mixins","toolbar","drawerPaper","whiteSpace","drawerPaperClose","defineProperty","overflowX","spacing","breakpoints","up","drawerSmallScreenSpacer","minWidth","drawerSmallScreen","withRouter","AppMenuTooltip","tooltipProps","Fragment","children","Tooltip","placement","smallScreen","measure","window","innerWidth","height","innerHeight","slicedToArray","dimension","setDimension","onResize","addEventListener","removeEventListener","useWindowDimension","Drawer","paper","open","ChevronLeft_default","Divider","List","ListItem","button","history","push","ListItemIcon","Dashboard_default","ListItemText","primary","Help_default","LearnMorePage","React","lazy","__webpack_require__","e","bind","ListPage","NotFoundPage","root","appBarSpacer","content","overflow","AuthenticatedApp","setDrawerOpened","CssBaseline","s","authenticated_AuthenticatedMenu","react_router","exact","path","component"],"mappings":"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","file":"static/js/4.2d3fde0d.chunk.js","sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport * as Api from '../api';\r\nimport { useNotification } from './NotificationContext';\r\nimport { useAuthentication } from './AuthenticationContext';\r\n\r\nexport enum TodoState {\r\n  Noop = 'noop',\r\n  Add = 'add',\r\n  Edit = 'edit',\r\n  Remove = 'remove'\r\n}\r\nexport type TodoType = {\r\n  data: Api.Todo;\r\n  state: TodoState;\r\n};\r\nexport type TodoListContextType = {\r\n  ready: boolean;\r\n  todos: TodoType[];\r\n  addTodo: (task: string) => void;\r\n  toggleTodo: (guid: string) => void;\r\n  removeTodo: (guid: string) => void;\r\n};\r\n\r\nconst defaultTodoList = {} as TodoListContextType;\r\nconst TodoListContext = createContext(defaultTodoList);\r\n\r\nexport function TodoListProvider<TProps>(props: TProps) {\r\n  const { error } = useNotification();\r\n  const { token, logout } = useAuthentication();\r\n  const [ready, setReady] = useState(false);\r\n  const [todos, setTodos] = useState([] as TodoType[]);\r\n\r\n  useEffect(() => {\r\n    const listener = (newTodos: Api.Todo[]) => {\r\n      setReady(true);\r\n      setTodos(ts => {\r\n        const todosBeingAdded: { [guid: string]: Api.Todo } = ts\r\n          .filter(t => t.state === TodoState.Add)\r\n          .reduce((acc, t) => ({ ...acc, [t.data.guid]: t.data }), {});\r\n        const todosBeingEdited: { [guid: string]: Api.Todo } = ts\r\n          .filter(t => t.state === TodoState.Edit)\r\n          .reduce((acc, t) => ({ ...acc, [t.data.guid]: t.data }), {});\r\n        const todosBeingRemoved: { [guid: string]: Api.Todo } = ts\r\n          .filter(t => t.state === TodoState.Remove)\r\n          .reduce((acc, t) => ({ ...acc, [t.data.guid]: t.data }), {});\r\n\r\n        return newTodos\r\n          .filter(t => todosBeingAdded[t.guid] === undefined)\r\n          .map(t => {\r\n            // Remove, Edit and Noop\r\n            if (todosBeingEdited[t.guid]) return { state: TodoState.Edit, data: todosBeingEdited[t.guid] };\r\n            if (todosBeingRemoved[t.guid]) return { state: TodoState.Remove, data: todosBeingRemoved[t.guid] };\r\n            return { state: TodoState.Noop, data: t };\r\n          })\r\n          .concat(ts.filter(t => t.state === TodoState.Add)); // Add\r\n      });\r\n    };\r\n    const handle = Api.addTodoListener(token, listener, () => {\r\n      error('Revoked token, connection lost');\r\n      logout(true);\r\n    });\r\n    return () => Api.removeTodoListener(handle);\r\n  }, [token, logout, error]);\r\n\r\n  const addTodo = (task: string) => {\r\n    const guid = Math.random()\r\n      .toString(16)\r\n      .substr(2);\r\n    const todo = { guid, task, done: false };\r\n\r\n    setTodos(ts => [...ts, { state: TodoState.Add, data: todo }]);\r\n    Api.addTodo(token, todo).then(r => {\r\n      if (!r) {\r\n        error(`Failed to add todo: ${todo.task}`);\r\n        setTodos(ts => ts.filter(t => t.data.guid !== guid));\r\n      } else {\r\n        // We apply the modification\r\n        setTodos(ts => ts.map(t => (t.data.guid === guid ? { state: TodoState.Noop, data: todo } : t)));\r\n      }\r\n    });\r\n  };\r\n\r\n  const toggleTodo = (guid: string) => {\r\n    const prevTodo = todos.find(t => t.data.guid === guid && t.state === TodoState.Noop);\r\n    if (!prevTodo) {\r\n      error(`No todo available for modification given guid ${guid}`);\r\n      return;\r\n    }\r\n\r\n    const todo = { ...prevTodo.data, done: !prevTodo.data.done };\r\n\r\n    setTodos(ts => ts.map(t => (t.data.guid === guid ? { state: TodoState.Edit, data: todo } : t)));\r\n    Api.editTodo(token, todo).then(r => {\r\n      if (!r) {\r\n        error(`Failed to edit todo: ${prevTodo.data.task}`);\r\n        setTodos(ts => ts.map(t => (t.data.guid === guid ? prevTodo : t)));\r\n      } else {\r\n        // We apply the modification\r\n        setTodos(ts => ts.map(t => (t.data.guid === guid ? { state: TodoState.Noop, data: todo } : t)));\r\n      }\r\n    });\r\n  };\r\n\r\n  const removeTodo = (guid: string) => {\r\n    const prevTodo = todos.find(t => t.data.guid === guid && t.state === TodoState.Noop);\r\n    if (!prevTodo) {\r\n      error(`No todo available for modification given guid ${guid}`);\r\n      return;\r\n    }\r\n\r\n    setTodos(ts => ts.map(t => (t.data.guid === guid ? { state: TodoState.Remove, data: prevTodo.data } : t)));\r\n    Api.removeTodo(token, prevTodo.data).then(r => {\r\n      if (!r) {\r\n        error(`Failed to remove todo: ${prevTodo.data.task}`);\r\n        setTodos(ts => ts.map(t => (t.data.guid === guid ? prevTodo : t)));\r\n      } else {\r\n        // We apply the modification\r\n        setTodos(ts => ts.filter(t => t.data.guid !== guid));\r\n      }\r\n    });\r\n  };\r\n\r\n  return <TodoListContext.Provider value={{ ready, todos, addTodo, toggleTodo, removeTodo }} {...props} />;\r\n}\r\n\r\nexport function useTodoList() {\r\n  const context = useContext(TodoListContext);\r\n  if (context === defaultTodoList) {\r\n    throw new Error(`useTodoList must be used within a TodoListProvider`);\r\n  }\r\n  return context;\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { useAuthentication } from '../../context/AuthenticationContext';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport ShoppingCartIcon from '@material-ui/icons/ShoppingCart';\r\nimport PowerSettingsNewIcon from '@material-ui/icons/PowerSettingsNew';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport { useTodoList, TodoState } from '../../context/TodoListContext';\r\nimport Badge from '@material-ui/core/Badge';\r\n\r\nconst drawerWidth = 240;\r\nconst useStyles = makeStyles(theme => ({\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen\r\n    })\r\n  },\r\n  appBarShift: {\r\n    marginLeft: drawerWidth,\r\n    width: `calc(100% - ${drawerWidth}px)`,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen\r\n    })\r\n  },\r\n\r\n  menuButtonHidden: {\r\n    display: 'none'\r\n  },\r\n  title: {\r\n    flexGrow: 1\r\n  }\r\n}));\r\n\r\ntype Props = { drawerOpened: boolean; toggleDrawer: () => void };\r\n\r\nexport default function AuthenticatedHeader(props: Props) {\r\n  const classes = useStyles();\r\n  const { username, logout } = useAuthentication();\r\n  const { ready, todos } = useTodoList();\r\n\r\n  return (\r\n    <AppBar position=\"absolute\" className={clsx(classes.appBar, props.drawerOpened && classes.appBarShift)}>\r\n      <Toolbar>\r\n        <IconButton\r\n          edge=\"start\"\r\n          color=\"inherit\"\r\n          aria-label=\"Toggle drawer\"\r\n          onClick={() => props.toggleDrawer()}\r\n          className={clsx(props.drawerOpened && classes.menuButtonHidden)}\r\n        >\r\n          <MenuIcon />\r\n        </IconButton>\r\n        <Typography variant=\"h6\" className={classes.title}>\r\n          Welcome {username}\r\n        </Typography>\r\n        <IconButton>\r\n          <Badge\r\n            badgeContent={ready ? `${todos.filter(t => t.state !== TodoState.Remove).length}` : '?'}\r\n            color=\"primary\"\r\n          >\r\n            <ShoppingCartIcon />\r\n          </Badge>\r\n        </IconButton>\r\n        <IconButton\r\n          onClick={() => {\r\n            logout();\r\n          }}\r\n        >\r\n          <PowerSettingsNewIcon />\r\n        </IconButton>\r\n      </Toolbar>\r\n    </AppBar>\r\n  );\r\n}\r\n","import React, { ReactElement } from 'react';\r\nimport clsx from 'clsx';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport HelpIcon from '@material-ui/icons/Help';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport { withRouter, RouteComponentProps } from 'react-router-dom';\r\nimport { useWindowDimension } from '../../hook/WindowDimension';\r\n\r\nconst drawerWidth = 240;\r\nconst useStyles = makeStyles(theme => ({\r\n  toolbarIcon: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'flex-end',\r\n    padding: '0 8px',\r\n    ...theme.mixins.toolbar\r\n  },\r\n  drawerPaper: {\r\n    position: 'relative',\r\n    whiteSpace: 'nowrap',\r\n    width: drawerWidth,\r\n    transition: theme.transitions.create('width', {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen\r\n    })\r\n  },\r\n  drawerPaperClose: {\r\n    overflowX: 'hidden',\r\n    transition: theme.transitions.create('width', {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen\r\n    }),\r\n    width: theme.spacing(7),\r\n    [theme.breakpoints.up('sm')]: {\r\n      width: theme.spacing(9)\r\n    }\r\n  },\r\n  drawerSmallScreenSpacer: {\r\n    minWidth: theme.spacing(7),\r\n    [theme.breakpoints.up('sm')]: {\r\n      minWidth: theme.spacing(9)\r\n    }\r\n  },\r\n  drawerSmallScreen: {\r\n    position: 'absolute'\r\n  }\r\n}));\r\n\r\ntype Props = { drawerOpened: boolean; toggleDrawer: () => void } & RouteComponentProps;\r\n\r\nfunction AuthenticatedMenu(props: Props) {\r\n  const classes = useStyles();\r\n  const { width } = useWindowDimension();\r\n\r\n  const AppMenuTooltip = (tooltipProps: { title: string; children: ReactElement }) => {\r\n    if (props.drawerOpened) {\r\n      return <>{tooltipProps.children}</>;\r\n    }\r\n    return (\r\n      <Tooltip title={tooltipProps.title} placement=\"right\">\r\n        {tooltipProps.children}\r\n      </Tooltip>\r\n    );\r\n  };\r\n\r\n  const smallScreen = width < 2 * drawerWidth;\r\n\r\n  return (\r\n    <>\r\n      {smallScreen && <div className={classes.drawerSmallScreenSpacer}></div>}\r\n      <Drawer\r\n        variant=\"permanent\"\r\n        classes={{\r\n          paper: clsx(\r\n            classes.drawerPaper,\r\n            !props.drawerOpened && classes.drawerPaperClose,\r\n            smallScreen && classes.drawerSmallScreen\r\n          )\r\n        }}\r\n        open={props.drawerOpened}\r\n      >\r\n        <div className={classes.toolbarIcon}>\r\n          <IconButton onClick={() => props.toggleDrawer()}>\r\n            <ChevronLeftIcon />\r\n          </IconButton>\r\n        </div>\r\n        <Divider />\r\n        <List>\r\n          <AppMenuTooltip title=\"Todos\">\r\n            <ListItem button onClick={() => props.history.push('/')}>\r\n              <ListItemIcon>\r\n                <DashboardIcon />\r\n              </ListItemIcon>\r\n              <ListItemText primary=\"Todos\" />\r\n            </ListItem>\r\n          </AppMenuTooltip>\r\n          <AppMenuTooltip title=\"Learn more\">\r\n            <ListItem button onClick={() => props.history.push('/learn-more')}>\r\n              <ListItemIcon>\r\n                <HelpIcon />\r\n              </ListItemIcon>\r\n              <ListItemText primary=\"Learn more\" />\r\n            </ListItem>\r\n          </AppMenuTooltip>\r\n        </List>\r\n      </Drawer>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withRouter(AuthenticatedMenu);\r\n","import { useState, useEffect } from 'react';\r\n\r\nexport function useWindowDimension() {\r\n  const measure = () => ({ width: window.innerWidth, height: window.innerHeight });\r\n  const [dimension, setDimension] = useState(() => measure());\r\n\r\n  useEffect(() => {\r\n    const onResize = () => {\r\n      setDimension(measure());\r\n    };\r\n    window.addEventListener('resize', onResize);\r\n    return () => window.removeEventListener('resize', onResize);\r\n  }, []);\r\n  return dimension;\r\n}\r\n","import React, { useState } from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport AuthenticatedHeader from './AuthenticatedHeader';\r\nimport { TodoListProvider } from '../../context/TodoListContext';\r\nimport AppMenu from './AuthenticatedMenu';\r\nimport { Switch, Route } from 'react-router-dom';\r\n\r\nconst LearnMorePage = React.lazy(() => import('./learn-more/LearnMorePage'));\r\nconst ListPage = React.lazy(() => import('./list/ListPage'));\r\nconst NotFoundPage = React.lazy(() => import('./not-found/NotFoundPage'));\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  root: {\r\n    display: 'flex'\r\n  },\r\n  appBarSpacer: theme.mixins.toolbar,\r\n  content: {\r\n    flexGrow: 1,\r\n    overflow: 'auto',\r\n    height: '100vh',\r\n    padding: '2em'\r\n  }\r\n}));\r\n\r\ntype Props = {};\r\n\r\nexport default function AuthenticatedApp(props: Props) {\r\n  const classes = useStyles();\r\n  const [drawerOpened, setDrawerOpened] = useState(false);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <TodoListProvider>\r\n        <CssBaseline />\r\n        <AuthenticatedHeader drawerOpened={drawerOpened} toggleDrawer={() => setDrawerOpened(s => !s)} />\r\n        <AppMenu drawerOpened={drawerOpened} toggleDrawer={() => setDrawerOpened(s => !s)} />\r\n        <main className={classes.content}>\r\n          <div className={classes.appBarSpacer}></div>\r\n          <Switch>\r\n            <Route exact path=\"/\" component={ListPage} />\r\n            <Route exact path=\"/learn-more\" component={LearnMorePage} />\r\n            <Route component={NotFoundPage} />\r\n          </Switch>\r\n        </main>\r\n      </TodoListProvider>\r\n    </div>\r\n  );\r\n}\r\n"],"sourceRoot":""}